
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CHYA B </title>
    <style>
        /*
        GLOBAL STYLES AND RESETS
        */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 25%, #16213e 50%, #0f3460 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background:
                radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(120, 219, 226, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }

        /*
        HEADER
        */
        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 3.5rem;
            margin-bottom: 15px;
            text-shadow: 0 0 30px rgba(120, 119, 198, 0.8), 0 0 60px rgba(120, 119, 198, 0.4);
            background: linear-gradient(135deg, #ff7ac6 0%, #bf8cff 25%, #8cc8ff 50%, #80ffdb 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: glow 3s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { filter: drop-shadow(0 0 20px rgba(120, 119, 198, 0.5)); }
            to { filter: drop-shadow(0 0 40px rgba(255, 119, 198, 0.8)); }
        }

        .header p {
            font-size: 1.3rem;
            opacity: 0.8;
            color: #b0b0b0;
        }

        /*
        DATA SOURCE INDICATORS
        */
        .data-source {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .source-indicator {
            padding: 12px 24px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 30px;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
        }

        .source-indicator.active {
            background: rgba(120, 119, 198, 0.25);
            border-color: rgba(120, 119, 198, 0.6);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(120, 119, 198, 0.3);
        }

        .source-indicator .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #ff6b6b;
            transition: all 0.3s ease;
        }

        .source-indicator.active .status-dot {
            background: #51cf66;
            box-shadow: 0 0 15px rgba(81, 207, 102, 0.6);
        }

        /*
        STATS SECTION
        */
        .stats {
            display: flex;
            justify-content: center;
            gap: 50px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }

        .stat-item {
            text-align: center;
            color: white;
            padding: 20px 30px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease;
        }

        .stat-item:hover {
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            display: block;
            background: linear-gradient(135deg, #ff7ac6, #bf8cff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            font-size: 1rem;
            opacity: 0.8;
            margin-top: 8px;
        }

        /*
        CONTROLS
        */
        .controls {
            display: flex;
            gap: 20px;
            margin-bottom: 40px;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
        }

        .search-container {
            position: relative;
            flex: 1;
            max-width: 500px;
        }

        .search-box {
            width: 100%;
            padding: 20px 60px 20px 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 50px;
            font-size: 16px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            box-shadow:
                0 8px 32px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            color: white;
            transition: all 0.3s ease;
        }

        .search-box::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .search-box:focus {
            outline: none;
            border-color: rgba(120, 119, 198, 0.5);
            box-shadow:
                0 8px 32px rgba(0, 0, 0, 0.4),
                0 0 0 1px rgba(120, 119, 198, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .search-clear {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.6);
            font-size: 20px;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            transition: all 0.3s ease;
            display: none;
        }

        .search-clear:hover {
            color: white;
            background: rgba(255, 255, 255, 0.1);
        }

        .search-clear.visible {
            display: block;
        }

        .filter-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 18px 30px;
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 50px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.05);
            color: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            box-shadow:
                0 8px 32px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
            outline-offset: 4px;
            white-space: nowrap;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover, .btn:focus-visible {
            transform: translateY(-3px);
            box-shadow:
                0 15px 45px rgba(0, 0, 0, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            border-color: rgba(120, 119, 198, 0.3);
        }

        .btn.active {
            background: rgba(120, 119, 198, 0.25);
            border-color: rgba(120, 119, 198, 0.6);
            color: white;
            box-shadow:
                0 8px 32px rgba(120, 119, 198, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        /*
        SORT OPTIONS
        */
        .sort-container {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 30px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .sort-select {
            padding: 12px 20px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 25px;
            color: white;
            font-size: 14px;
            cursor: pointer;
            outline: none;
            transition: all 0.3s ease;
            appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='white' viewBox='0 0 16 16'%3e%3cpath d='m7.247 4.86-4.796 5.481c-.566.647-.106 1.659.753 1.659h9.592a1 1 0 0 0 .753-1.659l-4.796-5.48a1 1 0 0 0-1.506 0z'/%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 12px;
            padding-right: 45px;
        }

        .sort-select:focus-visible {
            border-color: rgba(120, 119, 198, 0.5);
            box-shadow: 0 0 0 2px rgba(120, 119, 198, 0.3);
        }

        .sort-select option {
            background: #1a1a2e;
            color: white;
            padding: 10px;
        }

        /*
        LOADING / ERROR MESSAGES
        */
        .loading {
            text-align: center;
            color: white;
            font-size: 18px;
            margin: 40px 0;
        }

        .error {
            text-align: center;
            color: white;
            background: rgba(231, 76, 60, 0.2);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(231, 76, 60, 0.3);
        }

        /*
        GAMES GRID
        */
        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 30px;
            margin-top: 30px;
            min-height: 400px;
        }

        .game-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 25px;
            overflow: hidden;
            box-shadow:
                0 15px 35px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            transition: all 0.4s cubic-bezier(0.23, 1, 0.320, 1);
            cursor: pointer;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .game-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(120, 119, 198, 0.1) 0%, rgba(255, 119, 198, 0.05) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
            border-radius: 25px;
        }

        .game-card:hover::before {
            opacity: 1;
        }

        .game-card:hover {
            transform: translateY(-15px) scale(1.02);
            box-shadow:
                0 30px 60px rgba(0, 0, 0, 0.4),
                0 0 0 1px rgba(120, 119, 198, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            border-color: rgba(120, 119, 198, 0.4);
        }

        /* Skeleton loading styles */
        .loading-skeleton {
            pointer-events: none;
            animation: pulse 1.5s infinite alternate;
        }

        @keyframes pulse {
            0% { opacity: 0.6; }
            100% { opacity: 1; }
        }

        .loading-skeleton .game-image,
        .loading-skeleton .game-title,
        .loading-skeleton .game-description,
        .loading-skeleton .game-price,
        .loading-skeleton .game-rating,
        .loading-skeleton .download-btn {
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: transparent;
            pointer-events: none;
        }

        /* ENHANCED IMAGE STYLES */
        .game-image {
            width: 100%;
            height: 220px;
            background: linear-gradient(135deg, rgba(120, 119, 198, 0.2), rgba(255, 119, 198, 0.1));
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .game-image::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, transparent 0%, rgba(0, 0, 0, 0.2) 100%);
            pointer-events: none;
            z-index: 1;
        }

        .game-image .image-container {
            width: 100%;
            height: 100%;
            position: relative;
            overflow: hidden;
        }

        .game-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.4s ease, opacity 0.3s ease;
            display: block;
            opacity: 0;
        }

        .game-image img.loaded {
            opacity: 1;
        }

        .game-image img.error {
            display: none;
        }

        .game-image .image-fallback {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 60px;
            color: rgba(255, 255, 255, 0.6);
            background: linear-gradient(135deg, rgba(120, 119, 198, 0.3), rgba(255, 119, 198, 0.2));
            transition: opacity 0.3s ease;
        }

        .game-image .image-fallback.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .game-image .image-fallback .fallback-text {
            font-size: 14px;
            margin-top: 10px;
            opacity: 0.8;
        }

        .game-image .image-loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            color: rgba(255, 255, 255, 0.7);
            z-index: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .game-image .image-loading.hidden {
            display: none;
        }

        .game-card:hover .game-image img.loaded {
            transform: scale(1.1);
        }

        /* Game ID Badge */
        .game-id-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
            z-index: 10;
            backdrop-filter: blur(10px);
        }

        .game-info {
            padding: 25px;
            position: relative;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .game-title {
            font-size: 1.6rem;
            font-weight: 700;
            margin-bottom: 15px;
            color: white;
            line-height: 1.3;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .game-description {
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.6;
            margin-bottom: 20px;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
            flex-grow: 1;
            font-size: 0.95rem;
        }

        .game-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: auto;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            gap: 15px;
        }

        .game-price {
            font-weight: 700;
            font-size: 1.4rem;
            color: #64ffda;
            text-shadow: 0 0 10px rgba(100, 255, 218, 0.5);
        }

        .game-rating {
            display: flex;
            align-items: center;
            gap: 5px;
            color: #ffd700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
            font-weight: 600;
        }

        .download-btn {
            padding: 14px 24px;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            border: none;
            border-radius: 25px;
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            outline-offset: 4px;
        }

        .download-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .download-btn:hover::before {
            left: 100%;
        }

        .download-btn:hover, .download-btn:focus-visible {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.4);
            background: linear-gradient(135deg, #ff5252 0%, #d63031 100%);
        }

        .download-btn:active {
            transform: translateY(0);
        }

        /*
        PAGINATION
        */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 50px;
            flex-wrap: wrap;
        }

        .pagination-btn {
            padding: 12px 16px;
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.05);
            color: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
            min-width: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            outline-offset: 4px;
        }

        .pagination-btn:hover:not(.disabled), .pagination-btn:focus-visible:not(.disabled) {
            background: rgba(120, 119, 198, 0.2);
            border-color: rgba(120, 119, 198, 0.5);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(120, 119, 198, 0.3);
        }

        .pagination-btn.active {
            background: linear-gradient(135deg, #7c4dff 0%, #3f51b5 100%);
            border-color: rgba(124, 77, 255, 0.8);
            color: white;
            box-shadow: 0 6px 20px rgba(124, 77, 255, 0.4);
            cursor: default;
        }

        .pagination-btn.disabled {
            opacity: 0.4;
            cursor: not-allowed;
            transform: none;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
        }

        .pagination-info {
            padding: 12px 20px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
            margin: 0 15px;
        }

        /*
        PAGE SIZE SELECTOR
        */
        .page-size-selector {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 30px;
            justify-content: center;
            padding-bottom: 50px;
        }

        .page-size-selector select {
            padding: 10px 18px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 12px;
            color: white;
            font-size: 14px;
            cursor: pointer;
            outline: none;
            transition: all 0.3s ease;
        }

        .page-size-selector select:focus-visible {
            border-color: rgba(120, 119, 198, 0.5);
            box-shadow: 0 0 0 2px rgba(120, 119, 198, 0.3);
        }

        .page-size-selector select option {
            background: #1a1a2e;
            color: white;
        }

        .page-size-selector label {
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
            font-weight: 500;
        }

        /*
        MODAL STYLES
        */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1001;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .modal-overlay.open {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(30px);
            -webkit-backdrop-filter: blur(30px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 25px;
            padding: 40px;
            max-width: 700px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            position: relative;
            color: white;
            transform: translateY(20px);
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease;
        }

        .modal-overlay.open .modal-content {
            transform: translateY(0);
            opacity: 1;
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            font-size: 1.5rem;
            color: rgba(255, 255, 255, 0.7);
            cursor: pointer;
            transition: all 0.3s ease;
            line-height: 1;
            outline-offset: 4px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
        }

        .modal-close:hover, .modal-close:focus-visible {
            color: white;
            background: rgba(255, 255, 255, 0.2);
        }

        .modal-image {
            width: 100%;
            height: 300px;
            background-color: rgba(120, 119, 198, 0.2);
            border-radius: 20px;
            margin-bottom: 30px;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            position: relative;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .modal-image:hover {
            transform: scale(1.02);
        }

        .modal-image .image-container {
            width: 100%;
            height: 100%;
            position: relative;
        }

        .modal-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: opacity 0.3s ease;
            opacity: 0;
        }

        .modal-image img.loaded {
            opacity: 1;
        }

        .modal-image .image-fallback {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 100px;
            color: rgba(255, 255, 255, 0.7);
            background: linear-gradient(135deg, rgba(120, 119, 198, 0.3), rgba(255, 119, 198, 0.2));
        }

        .modal-image .image-fallback.hidden {
            opacity: 0;
        }

        .modal-image .zoom-hint {
            position: absolute;
            bottom: 15px;
            right: 15px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 12px;
            opacity: 0;
            transition: opacity 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .modal-image:hover .zoom-hint {
            opacity: 1;
        }

        .modal-title {
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: #80ffdb;
            text-shadow: 0 0 15px rgba(128, 255, 219, 0.3);
            line-height: 1.2;
        }

        .modal-description {
            color: rgba(255, 255, 255, 0.85);
            line-height: 1.7;
            margin-bottom: 30px;
            font-size: 1.05rem;
        }

        .modal-meta {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
            padding: 25px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .modal-meta-item {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
        }

        .modal-meta-item .icon {
            font-size: 1.5rem;
            color: #bf8cff;
            flex-shrink: 0;
        }

        .modal-meta-item .value {
            word-break: break-all;
        }

        .modal-buttons {
            display: flex;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .modal-buttons .download-btn {
            flex: 1;
            justify-content: center;
            min-width: 200px;
            padding: 16px 30px;
            font-size: 1rem;
        }

        /* Image zoom overlay */
        .image-zoom-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
            cursor: pointer;
        }

        .image-zoom-overlay.open {
            opacity: 1;
            visibility: visible;
        }

        .image-zoom-overlay img {
            max-width: 95%;
            max-height: 95%;
            object-fit: contain;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            transform: scale(0.8);
            transition: transform 0.3s ease;
        }

        .image-zoom-overlay.open img {
            transform: scale(1);
        }

        .image-zoom-close {
            position: absolute;
            top: 30px;
            right: 30px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            font-size: 2rem;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
            transition: background 0.3s ease;
            outline-offset: 4px;
        }

        .image-zoom-close:hover, .image-zoom-close:focus-visible {
            background: rgba(255, 255, 255, 0.2);
        }

        /*
        RESPONSIVENESS
        */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.5rem;
            }

            .header p {
                font-size: 1.1rem;
            }

            .controls {
                flex-direction: column;
                align-items: stretch;
            }

            .search-container {
                max-width: 100%;
            }

            .filter-buttons {
                justify-content: center;
            }

            .btn {
                flex: 1;
                min-width: 120px;
            }

            .games-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .stats {
                gap: 30px;
            }

            .stat-item {
                padding: 15px 20px;
            }

            .modal-content {
                padding: 25px;
                width: 95%;
                margin: 20px;
            }

            .modal-close {
                top: 15px;
                right: 15px;
                width: 35px;
                height: 35px;
                font-size: 1.2rem;
            }

            .modal-title {
                font-size: 1.8rem;
                margin-top: 10px;
            }

            .modal-description {
                font-size: 0.95rem;
            }

            .modal-meta {
                grid-template-columns: 1fr;
                gap: 15px;
                padding: 20px;
            }

            .modal-buttons {
                flex-direction: column;
            }

            .modal-buttons .download-btn {
                min-width: auto;
            }

            .image-zoom-close {
                top: 20px;
                right: 20px;
                width: 40px;
                height: 40px;
                font-size: 1.5rem;
            }

            .sort-container {
                flex-direction: column;
                gap: 10px;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 0 10px;
            }

            body {
                padding: 10px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .games-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .game-card {
                border-radius: 20px;
            }

            .game-image {
                height: 180px;
            }

            .game-info {
                padding: 20px;
            }

            .game-title {
                font-size: 1.4rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎮 CHYA B</h1>
            <p>Discover amazing games from multiple sources</p>
        </div>

        <div class="data-source" id="dataSources">
            <div class="source-indicator" id="jsonSource">
                <span class="status-dot" aria-hidden="true"></span>
                📄 Primary API
            </div>
            <div class="source-indicator" id="zipSource">
                <span class="status-dot" aria-hidden="true"></span>
                📦 Steam Database
            </div>
        </div>

        <div class="stats" id="stats">
            <div class="stat-item">
                <span class="stat-number" id="totalGames">-</span>
                <span class="stat-label">Total Games</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="freeGames">-</span>
                <span class="stat-label">Free Games</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="avgRating">-</span>
                <span class="stat-label">Avg Rating</span>
            </div>
        </div>

        <div class="controls">
            <div class="search-container">
                <input type="text" class="search-box" id="searchInput" placeholder="Search by name, ID, or Steam URL (e.g., 2658510, Animal Shelter 2, or steam URL)...">
                <button class="search-clear" id="searchClear" aria-label="Clear search">&times;</button>
            </div>
            <div class="filter-buttons">
                <button class="btn active" id="allBtn">All Games</button>
                <button class="btn" id="freeBtn">Free Only</button>
                <button class="btn" id="steamBtn">🔍 Steam Lookup</button>
                <button class="btn" id="loadBtn">🔄 Refresh</button>
            </div>
        </div>

        <div class="steam-lookup-container" id="steamLookupContainer" style="display: none;">
            <div style="background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 20px; padding: 25px; margin-bottom: 30px;">
                <h3 style="color: white; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                    <span>🔍</span>
                    <span>Steam Game Lookup</span>
                </h3>
                <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: center;">
                    <input type="text" class="search-box" id="steamLookupInput" placeholder="Enter Steam App ID, game name, or Steam URL..." style="flex: 1; min-width: 300px;">
                    <button class="btn" id="steamLookupBtn" style="background: linear-gradient(135deg, #1b2838 0%, #2a475e 100%); border-color: rgba(102, 192, 244, 0.5);">
                        <span>🔍</span>
                        <span>Look Up</span>
                    </button>
                </div>
                <div id="steamLookupResult" style="margin-top: 20px;"></div>
            </div>
        </div>

        <div class="sort-container">
            <label for="sortSelect">Sort by:</label>
            <select class="sort-select" id="sortSelect">
                <option value="name">Name (A-Z)</option>
                <option value="name-desc">Name (Z-A)</option>
                <option value="rating">Rating (High to Low)</option>
                <option value="rating-asc">Rating (Low to High)</option>
                <option value="id">Game ID (Low to High)</option>
                <option value="id-desc">Game ID (High to Low)</option>
            </select>
        </div>

        <div id="loading" class="loading" style="display: none;" role="status" aria-live="polite">
            🎲 Loading games...
        </div>

        <div id="error" class="error" style="display: none;" role="alert" aria-live="assertive"></div>

        <div class="games-grid" id="gamesGrid"></div>

        <div class="pagination" id="pagination"></div>

        <div class="page-size-selector">
            <label for="pageSizeSelect">Games per page:</label>
            <select id="pageSizeSelect">
                <option value="6">6</option>
                <option value="12" selected>12</option>
                <option value="24">24</option>
                <option value="48">48</option>
            </select>
        </div>
    </div>

    <!-- Game Details Modal -->
    <div class="modal-overlay" id="gameDetailsModal" aria-modal="true" role="dialog" aria-labelledby="modalTitle">
        <div class="modal-content">
            <button class="modal-close" aria-label="Close game details" id="closeModalBtn">&times;</button>
            <div class="modal-image" id="modalImage" onclick="gameDiscovery.zoomImage()" tabindex="0" role="button" aria-label="Click to zoom image">
                <div class="zoom-hint">🔍 Click to zoom</div>
            </div>
            <h2 class="modal-title" id="modalTitle"></h2>
            <p class="modal-description" id="modalDescription"></p>
            <div class="modal-meta">
                <div class="modal-meta-item">
                    <span class="icon">💰</span>
                    <span class="value" id="modalPrice"></span>
                </div>
                <div class="modal-meta-item">
                    <span class="icon">⭐</span>
                    <span class="value" id="modalRating"></span>
                </div>
                <div class="modal-meta-item">
                    <span class="icon">📦</span>
                    <span class="value" id="modalZipFile"></span>
                </div>
                <div class="modal-meta-item">
                    <span class="icon">🆔</span>
                    <span class="value" id="modalGameId"></span>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="download-btn" id="modalDownloadBtn">
                    <span>📥</span>
                    <span>Download Game</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Image Zoom Overlay -->
    <div class="image-zoom-overlay" id="imageZoomOverlay" onclick="gameDiscovery.closeImageZoom()">
        <button class="image-zoom-close" onclick="gameDiscovery.closeImageZoom()" aria-label="Close zoomed image">&times;</button>
        <img id="zoomedImage" alt="Zoomed game image">
    </div>

    <script>
        class GameDiscovery {
            constructor() {
                this.games = [];
                this.filteredGames = [];
                this.currentFilter = 'all';
                this.searchTerm = '';
                this.sortBy = 'name';
                this.dataSources = {
                    json: false,
                    steam: false
                };

                // Pagination properties
                this.currentPage = 1;
                this.itemsPerPage = 12;
                this.totalPages = 1;

                // Modal elements
                this.modal = document.getElementById('gameDetailsModal');
                this.modalImage = document.getElementById('modalImage');
                this.modalTitle = document.getElementById('modalTitle');
                this.modalDescription = document.getElementById('modalDescription');
                this.modalPrice = document.getElementById('modalPrice');
                this.modalRating = document.getElementById('modalRating');
                this.modalZipFile = document.getElementById('modalZipFile');
                this.modalGameId = document.getElementById('modalGameId');
                this.modalDownloadBtn = document.getElementById('modalDownloadBtn');
                this.closeModalBtn = document.getElementById('closeModalBtn');

                // Image zoom elements
                this.imageZoomOverlay = document.getElementById('imageZoomOverlay');
                this.zoomedImage = document.getElementById('zoomedImage');

                // Search elements
                this.searchInput = document.getElementById('searchInput');
                this.searchClear = document.getElementById('searchClear');

                // Sort element
                this.sortSelect = document.getElementById('sortSelect');

                // Constants for notification
                this.NOTIFICATION_SHOW_DELAY = 100;
                this.NOTIFICATION_DURATION = 3000;
                this.NOTIFICATION_HIDE_DURATION = 300;

                // Current game for modal
                this.currentModalGame = null;

                this.initEventListeners();
                this.loadGames();
            }

            initEventListeners() {
                // Search functionality
                this.searchInput.addEventListener('input', (e) => {
                    this.searchTerm = e.target.value.toLowerCase();
                    this.currentPage = 1;
                    this.updateSearchClearButton();
                    
                    // Check if input looks like Steam URL or App ID
                    this.checkForSteamInput(e.target.value);
                    
                    this.filterAndSortGames();
                });

                this.searchClear.addEventListener('click', () => {
                    this.searchInput.value = '';
                    this.searchTerm = '';
                    this.currentPage = 1;
                    this.updateSearchClearButton();
                    this.filterAndSortGames();
                    this.searchInput.focus();
                });

                // Filter buttons
                document.getElementById('allBtn').addEventListener('click', () => {
                    this.setFilter('all');
                });

                document.getElementById('freeBtn').addEventListener('click', () => {
                    this.setFilter('free');
                });

                document.getElementById('steamBtn').addEventListener('click', () => {
                    this.toggleSteamLookup();
                });

                document.getElementById('loadBtn').addEventListener('click', () => {
                    this.loadGames();
                });

                // Steam lookup functionality
                document.getElementById('steamLookupBtn').addEventListener('click', () => {
                    this.performSteamLookup();
                });

                document.getElementById('steamLookupInput').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        this.performSteamLookup();
                    }
                });

                // Sort functionality
                this.sortSelect.addEventListener('change', (e) => {
                    this.sortBy = e.target.value;
                    this.currentPage = 1;
                    this.filterAndSortGames();
                });

                // Page size selector
                document.getElementById('pageSizeSelect').addEventListener('change', (e) => {
                    this.itemsPerPage = parseInt(e.target.value);
                    this.currentPage = 1;
                    this.updatePagination();
                    this.renderCurrentPage();
                });

                // Modal event listeners
                this.closeModalBtn.addEventListener('click', () => this.closeModal());
                this.modal.addEventListener('click', (e) => {
                    if (e.target === this.modal) {
                        this.closeModal();
                    }
                });

                // Image zoom event listeners
                this.imageZoomOverlay.addEventListener('click', (e) => {
                    if (e.target === this.imageZoomOverlay) {
                        this.closeImageZoom();
                    }
                });

                // Keyboard event listeners
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        if (this.imageZoomOverlay.classList.contains('open')) {
                            this.closeImageZoom();
                        } else if (this.modal.classList.contains('open')) {
                            this.closeModal();
                        }
                    }
                });

                // Modal image keyboard support
                this.modalImage.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        this.zoomImage();
                    }
                });
            }

            updateSearchClearButton() {
                if (this.searchTerm.length > 0) {
                    this.searchClear.classList.add('visible');
                } else {
                    this.searchClear.classList.remove('visible');
                }
            }

            setFilter(filter) {
                this.currentFilter = filter;
                this.currentPage = 1;
                document.querySelectorAll('.btn').forEach(btn => btn.classList.remove('active'));
                document.getElementById(filter + 'Btn').classList.add('active');
                this.filterAndSortGames();
            }

            async loadGames() {
                this.showLoading(true);
                this.hideError();
                this.renderSkeletonCards();

                try {
                    const games = await this.fetchGameData();
                    this.games = games;
                    this.updateStats();
                    this.filterAndSortGames();
                } catch (error) {
                    this.showError('Failed to load games: ' + error.message);
                } finally {
                    this.showLoading(false);
                    this.clearSkeletonCards();
                }
            }

            async fetchGameData() {
                try {
                    const [jsonResponse, steamResponse] = await Promise.allSettled([
                        fetch('https://bebokurd.github.io/game.json'),
                        fetch('https://steamdatabase1.s3.eu-north-1.amazonaws.com/id.zip')
                    ]);

                    let games = [];

                    // Handle JSON API
                    if (jsonResponse.status === 'fulfilled' && jsonResponse.value.ok) {
                        const jsonData = await jsonResponse.value.json();
                        games = this.transformGameData(jsonData);
                        this.dataSources.json = true;
                        this.updateSourceIndicator('json', true);
                        console.log('✅ Primary API loaded successfully');
                    } else {
                        this.dataSources.json = false;
                        this.updateSourceIndicator('json', false);
                        console.warn('❌ Primary API failed:', jsonResponse.reason || jsonResponse.value?.statusText);
                    }

                    // Handle Steam Database
                    if (steamResponse.status === 'fulfilled' && steamResponse.value.ok) {
                        try {
                            const steamData = await steamResponse.value.json();
                            const steamGames = this.transformGameData(steamData);
                            games = [...games, ...steamGames];
                            this.dataSources.steam = true;
                            this.updateSourceIndicator('steam', true);
                            console.log('✅ Steam Database loaded successfully');
                        } catch (parseError) {
                            this.dataSources.steam = false;
                            this.updateSourceIndicator('steam', false);
                            console.warn('❌ Steam Database parse error:', parseError.message);
                        }
                    } else {
                        this.dataSources.steam = false;
                        this.updateSourceIndicator('steam', false);
                        console.warn('❌ Steam Database failed:', steamResponse.reason || steamResponse.value?.statusText);
                    }

                    // Remove duplicates based on game_id
                    const uniqueGames = games.filter((game, index, self) =>
                        index === self.findIndex(g => g.id === game.id)
                    );

                    return uniqueGames.length > 0 ? uniqueGames : this.getSampleGames();

                } catch (error) {
                    console.error('Fatal error during game data fetch:', error);
                    this.updateSourceIndicator('json', false);
                    this.updateSourceIndicator('steam', false);
                    return this.getSampleGames();
                }
            }

            updateSourceIndicator(source, isActive) {
                const indicator = document.getElementById(source + 'Source');
                if (indicator) {
                    if (isActive) {
                        indicator.classList.add('active');
                    } else {
                        indicator.classList.remove('active');
                    }
                }
            }

            transformGameData(data) {
                const games = [];

                // Handle object with numbered keys (like your JSON structure)
                if (typeof data === 'object' && !Array.isArray(data)) {
                    for (const key in data) {
                        if (data.hasOwnProperty(key) && data[key]) {
                            const game = data[key];
                            // Ensure we have either game_id or a valid game object
                            if (game.game_id || game.game_name || game.name) {
                                games.push(game);
                            }
                        }
                    }
                } else if (Array.isArray(data)) {
                    games.push(...data);
                }

                return games.map((game, index) => {
                    const gameId = game.game_id || game.id || `game-${index}-${Math.random().toString(36).substring(2, 9)}`;
                    const gameName = game.game_name || game.name || game.title || `Game ${gameId}`;
                    
                    // Enhanced image handling with multiple fallback options
                    let imageUrl = null;
                    const possibleImageFields = [
                        'image_url', 'header_image', 'image', 'thumbnail', 'cover_image', 
                        'logo_url', 'steam_image', 'game_image', 'poster_url'
                    ];
                    
                    for (const field of possibleImageFields) {
                        if (game[field] && typeof game[field] === 'string' && game[field].trim()) {
                            imageUrl = game[field].trim();
                            break;
                        }
                    }

                    // If we have a Steam app ID, try to construct Steam image URLs
                    if (!imageUrl && (game.steam_id || game.appid || gameId)) {
                        const steamId = game.steam_id || game.appid || gameId;
                        if (/^\d+$/.test(steamId)) {
                            // Try Steam header image format
                            imageUrl = `https://cdn.akamai.steamstatic.com/steam/apps/${steamId}/header.jpg`;
                        }
                    }

                    // Enhanced description generation
                    let description = game.description || game.short_description;
                    if (!description && game.genres && Array.isArray(game.genres)) {
                        description = `Experience ${gameName}, an exciting ${game.genres.join(', ').toLowerCase()} game that will keep you entertained for hours!`;
                    } else if (!description) {
                        description = this.generateDescription(gameName);
                    }
                    
                    return {
                        id: gameId,
                        title: gameName,
                        description: description,
                        price: game.price || (game.is_free || game.free ? "Free" : "Free"),
                        image: imageUrl,
                        rating: game.rating || game.metacritic_score ? 
                            (game.metacritic_score ? (game.metacritic_score / 20).toFixed(1) : game.rating) : 
                            this.generateRating(),
                        isFree: game.is_free !== false, // Default to free unless explicitly stated otherwise
                        zipFile: game.zip_file || null,
                        gameId: gameId,
                        downloadUrl: game.zip_file ? `https://steamdatabase1.s3.eu-north-1.amazonaws.com/${game.zip_file}` : null,
                        // Additional metadata
                        genres: game.genres || [],
                        releaseDate: game.release_date || null,
                        developer: game.developer || null,
                        publisher: game.publisher || null
                    };
                });
            }

            generateDescription(gameName) {
                const descriptions = [
                    `Experience the thrilling world of ${gameName}! Dive into an adventure like no other.`,
                    `${gameName} offers endless entertainment with stunning gameplay and immersive storylines.`,
                    `Discover the excitement of ${gameName} - a game that will keep you engaged for hours.`,
                    `Join millions of players in ${gameName} and experience gaming at its finest.`,
                    `${gameName} brings you action-packed gameplay with incredible graphics and sound.`
                ];
                return descriptions[Math.floor(Math.random() * descriptions.length)];
            }

            generateRating() {
                return (Math.random() * 2 + 3).toFixed(1); // Random rating between 3.0 - 5.0
            }

            getSampleGames() {
                console.warn('Falling back to sample games as API data could not be loaded.');
                return [
                    {
                        id: 'sample-1',
                        title: "Epic Adventure Quest (Sample)",
                        description: "Embark on an epic journey through mystical lands filled with danger and wonder. This is a sample game, download may not work.",
                        price: "Free",
                        image: "https://images.unsplash.com/photo-1550745165-9bc0b252726f?w=400&h=300&fit=crop",
                        rating: "4.5",
                        isFree: true,
                        zipFile: "epic_adventure.zip",
                        gameId: "sample-1",
                        downloadUrl: "https://steamdatabase1.s3.eu-north-1.amazonaws.com/epic_adventure.zip"
                    },
                    {
                        id: 'sample-2',
                        title: "Space Combat Elite (Sample)",
                        description: "Command your spaceship in intense battles across the galaxy. Protect the human colonies from alien threats!",
                        price: "Free",
                        image: "https://images.unsplash.com/photo-1614728263952-84ea256f9679?w=400&h=300&fit=crop",
                        rating: "4.2",
                        isFree: true,
                        zipFile: "space_combat.zip",
                        gameId: "sample-2",
                        downloadUrl: "https://steamdatabase1.s3.eu-north-1.amazonaws.com/space_combat.zip"
                    },
                    {
                        id: 'sample-3',
                        title: "Puzzle Master Pro (Sample)",
                        description: "Challenge your mind with hundreds of unique puzzles and brain teasers. Sharpen your logic skills!",
                        price: "Free",
                        image: "https://images.unsplash.com/photo-1606092195730-5d7b9af1efc5?w=400&h=300&fit=crop",
                        rating: "4.7",
                        isFree: true,
                        zipFile: "puzzle_master.zip",
                        gameId: "sample-3",
                        downloadUrl: "https://steamdatabase1.s3.eu-north-1.amazonaws.com/puzzle_master.zip"
                    }
                ];
            }

            filterAndSortGames() {
                // Filter games
                this.filteredGames = this.games.filter(game => {
                    const matchesSearch = this.searchMatchesGame(game, this.searchTerm);
                    const matchesFilter = this.currentFilter === 'all' ||
                                        (this.currentFilter === 'free' && game.isFree);

                    return matchesSearch && matchesFilter;
                });

                // Sort games
                this.sortGames();

                this.updatePagination();
                this.renderCurrentPage();
            }

            // Enhanced search that handles Steam URLs, app IDs, and names
            searchMatchesGame(game, searchTerm) {
                if (!searchTerm) return true;

                const fields = [
                    game.title.toLowerCase(),
                    game.description.toLowerCase(),
                    game.id.toString().toLowerCase(),
                    game.gameId ? game.gameId.toString().toLowerCase() : ''
                ];

                // Check if search term is a Steam URL
                const steamUrlMatch = searchTerm.match(/store\.steampowered\.com\/app\/(\d+)/);
                if (steamUrlMatch) {
                    const steamId = steamUrlMatch[1];
                    return game.id === steamId || game.gameId === steamId || 
                           (game.image && game.image.includes(steamId));
                }

                // Check if search term is a numeric Steam App ID
                if (/^\d+$/.test(searchTerm.trim())) {
                    return game.id === searchTerm.trim() || game.gameId === searchTerm.trim() ||
                           (game.image && game.image.includes(searchTerm.trim()));
                }

                // Regular text search
                return fields.some(field => field.includes(searchTerm));
            }

            // Check if input looks like Steam content and provide hints
            checkForSteamInput(input) {
                const steamUrlMatch = input.match(/store\.steampowered\.com\/app\/(\d+)/);
                const numericMatch = /^\d{6,}$/.test(input.trim());

                if (steamUrlMatch || numericMatch) {
                    // Show a hint that this looks like Steam content
                    this.showSteamHint(steamUrlMatch ? steamUrlMatch[1] : input.trim());
                }
            }

            showSteamHint(appId) {
                // Remove existing hints
                const existingHint = document.querySelector('.steam-hint');
                if (existingHint) existingHint.remove();

                const hint = document.createElement('div');
                hint.className = 'steam-hint';
                hint.style.cssText = `
                    position: absolute;
                    top: 100%;
                    left: 0;
                    right: 0;
                    background: rgba(27, 40, 56, 0.95);
                    border: 1px solid rgba(102, 192, 244, 0.3);
                    border-radius: 0 0 15px 15px;
                    padding: 12px 20px;
                    color: white;
                    font-size: 13px;
                    z-index: 1000;
                    backdrop-filter: blur(10px);
                `;
                hint.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <span>💡</span>
                        <span>Detected Steam App ID: <strong>${appId}</strong></span>
                        <button onclick="this.parentElement.parentElement.remove()" style="margin-left: auto; background: none; border: none; color: rgba(255,255,255,0.7); cursor: pointer;">&times;</button>
                    </div>
                `;

                this.searchInput.parentElement.style.position = 'relative';
                this.searchInput.parentElement.appendChild(hint);

                // Auto-remove hint after 5 seconds
                setTimeout(() => {
                    if (hint.parentElement) hint.remove();
                }, 5000);
            }

            // Toggle Steam lookup panel
            toggleSteamLookup() {
                const container = document.getElementById('steamLookupContainer');
                const btn = document.getElementById('steamBtn');
                
                if (container.style.display === 'none') {
                    container.style.display = 'block';
                    btn.classList.add('active');
                    document.getElementById('steamLookupInput').focus();
                } else {
                    container.style.display = 'none';
                    btn.classList.remove('active');
                }
            }

            // Perform Steam game lookup
            async performSteamLookup() {
                const input = document.getElementById('steamLookupInput').value.trim();
                const resultDiv = document.getElementById('steamLookupResult');
                
                if (!input) {
                    resultDiv.innerHTML = '<div style="color: rgba(255,255,255,0.7);">Please enter a Steam App ID, game name, or Steam URL.</div>';
                    return;
                }

                // Extract App ID from various formats
                let appId = null;
                let searchQuery = input;

                // Check if it's a Steam URL
                const steamUrlMatch = input.match(/store\.steampowered\.com\/app\/(\d+)/);
                if (steamUrlMatch) {
                    appId = steamUrlMatch[1];
                }
                // Check if it's just a numeric App ID
                else if (/^\d+$/.test(input)) {
                    appId = input;
                }

                resultDiv.innerHTML = '<div style="color: rgba(255,255,255,0.7);">🔍 Looking up Steam game...</div>';

                try {
                    if (appId) {
                        // Show Steam game info if we have an App ID
                        await this.displaySteamGameInfo(appId);
                    } else {
                        // Search for game in current database
                        await this.searchInCurrentDatabase(searchQuery);
                    }
                } catch (error) {
                    resultDiv.innerHTML = `<div style="color: #ff6b6b;">❌ Error: ${error.message}</div>`;
                }
            }

            // Display Steam game information
            async displaySteamGameInfo(appId) {
                const resultDiv = document.getElementById('steamLookupResult');
                
                // Check if we already have this game in our database
                const existingGame = this.games.find(g => g.id === appId || g.gameId === appId);
                
                if (existingGame) {
                    resultDiv.innerHTML = `
                        <div style="background: rgba(76, 175, 80, 0.2); border: 1px solid rgba(76, 175, 80, 0.5); border-radius: 15px; padding: 20px;">
                            <h4 style="color: #4caf50; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                                <span>✅</span>
                                <span>Game Found in Database!</span>
                            </h4>
                            <div style="display: flex; gap: 15px; align-items: center;">
                                <div style="flex: 1;">
                                    <div style="font-weight: 600; color: white; margin-bottom: 5px;">${existingGame.title}</div>
                                    <div style="color: rgba(255,255,255,0.8); font-size: 14px;">App ID: ${appId}</div>
                                    <div style="color: rgba(255,255,255,0.8); font-size: 14px;">Rating: ⭐ ${existingGame.rating}</div>
                                </div>
                                <button onclick="gameDiscovery.showGameDetails('${existingGame.id}')" class="btn" style="padding: 10px 20px;">
                                    View Details
                                </button>
                            </div>
                        </div>
                    `;
                } else {
                    // Show Steam game info with link to Steam store
                    const steamGameInfo = this.getSteamGameInfo(appId);
                    resultDiv.innerHTML = `
                        <div style="background: rgba(27, 40, 56, 0.3); border: 1px solid rgba(102, 192, 244, 0.5); border-radius: 15px; padding: 20px;">
                            <h4 style="color: #66c0f4; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                                <span>🎮</span>
                                <span>Steam Game Info</span>
                            </h4>
                            <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
                                <div style="flex: 1; min-width: 200px;">
                                    <div style="font-weight: 600; color: white; margin-bottom: 5px;">Steam App ID: ${appId}</div>
                                    <div style="color: rgba(255,255,255,0.8); font-size: 14px; margin-bottom: 10px;">
                                        This game is not in our database yet, but you can view it on Steam.
                                    </div>
                                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                        <a href="https://store.steampowered.com/app/${appId}/" target="_blank" rel="noopener noreferrer" 
                                           style="display: inline-flex; align-items: center; gap: 8px; padding: 8px 16px; background: linear-gradient(135deg, #1b2838 0%, #2a475e 100%); color: white; text-decoration: none; border-radius: 20px; font-size: 14px; border: 1px solid rgba(102, 192, 244, 0.3);">
                                            <span>🔗</span>
                                            <span>View on Steam</span>
                                        </a>
                                        <a href="https://steamdb.info/app/${appId}/" target="_blank" rel="noopener noreferrer"
                                           style="display: inline-flex; align-items: center; gap: 8px; padding: 8px 16px; background: rgba(255, 255, 255, 0.1); color: white; text-decoration: none; border-radius: 20px; font-size: 14px; border: 1px solid rgba(255, 255, 255, 0.2);">
                                            <span>📊</span>
                                            <span>SteamDB</span>
                                        </a>
                                    </div>
                                </div>
                                <div style="width: 100px; height: 60px; background: linear-gradient(135deg, rgba(120, 119, 198, 0.3), rgba(255, 119, 198, 0.2)); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 24px;">
                                    🎮
                                </div>
                            </div>
                        </div>
                    `;
                }
            }

            // Search in current database by name
            async searchInCurrentDatabase(query) {
                const resultDiv = document.getElementById('steamLookupResult');
                const matches = this.games.filter(game => 
                    game.title.toLowerCase().includes(query.toLowerCase()) ||
                    game.description.toLowerCase().includes(query.toLowerCase())
                ).slice(0, 5); // Limit to 5 results

                if (matches.length > 0) {
                    const matchesHtml = matches.map(game => `
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: rgba(255, 255, 255, 0.05); border-radius: 10px; margin-bottom: 10px;">
                            <div>
                                <div style="font-weight: 600; color: white;">${game.title}</div>
                                <div style="color: rgba(255,255,255,0.7); font-size: 13px;">ID: ${game.id} • ⭐ ${game.rating}</div>
                            </div>
                            <button onclick="gameDiscovery.showGameDetails('${game.id}')" class="btn" style="padding: 6px 12px; font-size: 12px;">
                                View
                            </button>
                        </div>
                    `).join('');

                    resultDiv.innerHTML = `
                        <div style="background: rgba(76, 175, 80, 0.2); border: 1px solid rgba(76, 175, 80, 0.5); border-radius: 15px; padding: 20px;">
                            <h4 style="color: #4caf50; margin-bottom: 15px;">✅ Found ${matches.length} game(s) matching "${query}":</h4>
                            ${matchesHtml}
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <div style="background: rgba(255, 152, 0, 0.2); border: 1px solid rgba(255, 152, 0, 0.5); border-radius: 15px; padding: 20px;">
                            <h4 style="color: #ff9800; margin-bottom: 10px;">🔍 No matches found for "${query}"</h4>
                            <p style="color: rgba(255,255,255,0.8); margin: 0;">Try searching by exact game name or Steam App ID.</p>
                        </div>
                    `;
                }
            }

            // Get basic Steam game info (placeholder for future API integration)
            getSteamGameInfo(appId) {
                // In a real implementation, you might call Steam's API here
                return {
                    appId: appId,
                    steamUrl: `https://store.steampowered.com/app/${appId}/`,
                    steamDbUrl: `https://steamdb.info/app/${appId}/`
                };
            }

            sortGames() {
                this.filteredGames.sort((a, b) => {
                    switch (this.sortBy) {
                        case 'name':
                            return a.title.localeCompare(b.title);
                        case 'name-desc':
                            return b.title.localeCompare(a.title);
                        case 'rating':
                            return parseFloat(b.rating) - parseFloat(a.rating);
                        case 'rating-asc':
                            return parseFloat(a.rating) - parseFloat(b.rating);
                        case 'id':
                            return parseInt(a.id) - parseInt(b.id);
                        case 'id-desc':
                            return parseInt(b.id) - parseInt(a.id);
                        default:
                            return 0;
                    }
                });
            }

            updatePagination() {
                this.totalPages = Math.ceil(this.filteredGames.length / this.itemsPerPage);
                if (this.currentPage > this.totalPages && this.totalPages > 0) {
                    this.currentPage = this.totalPages;
                } else if (this.totalPages === 0 && this.filteredGames.length > 0) {
                    this.currentPage = 1;
                }
                this.renderPagination();
            }

            renderCurrentPage() {
                const startIndex = (this.currentPage - 1) * this.itemsPerPage;
                const endIndex = startIndex + this.itemsPerPage;
                const currentGames = this.filteredGames.slice(startIndex, endIndex);

                this.renderGames(currentGames);
            }

            goToPage(page) {
                if (page >= 1 && page <= this.totalPages) {
                    this.currentPage = page;
                    this.renderCurrentPage();
                    this.renderPagination();

                    document.getElementById('gamesGrid').scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            }

            renderPagination() {
                const pagination = document.getElementById('pagination');
                if (this.totalPages <= 1 && this.filteredGames.length <= this.itemsPerPage) {
                    pagination.innerHTML = '';
                    return;
                }

                let paginationHTML = '';

                // Previous button
                paginationHTML += `
                    <button class="pagination-btn ${this.currentPage === 1 ? 'disabled' : ''}"
                            onclick="gameDiscovery.goToPage(${this.currentPage - 1})"
                            ${this.currentPage === 1 ? 'disabled' : ''}
                            aria-label="Previous page">
                        ‹
                    </button>
                `;

                // Page numbers with smart truncation
                const maxVisible = 5;
                let startPage = Math.max(1, this.currentPage - Math.floor(maxVisible / 2));
                let endPage = Math.min(this.totalPages, startPage + maxVisible - 1);

                if (endPage - startPage + 1 < maxVisible) {
                    startPage = Math.max(1, endPage - maxVisible + 1);
                }

                // First page + ellipsis
                if (startPage > 1) {
                    paginationHTML += `
                        <button class="pagination-btn" onclick="gameDiscovery.goToPage(1)" aria-label="Page 1">1</button>
                    `;
                    if (startPage > 2) {
                        paginationHTML += `<span class="pagination-btn disabled" aria-hidden="true">...</span>`;
                    }
                }

                // Visible page numbers
                for (let i = startPage; i <= endPage; i++) {
                    paginationHTML += `
                        <button class="pagination-btn ${i === this.currentPage ? 'active' : ''}"
                                onclick="gameDiscovery.goToPage(${i})"
                                aria-label="Page ${i}"
                                ${i === this.currentPage ? 'aria-current="page"' : ''}>
                            ${i}
                        </button>
                    `;
                }

                // Ellipsis + last page
                if (endPage < this.totalPages) {
                    if (endPage < this.totalPages - 1) {
                        paginationHTML += `<span class="pagination-btn disabled" aria-hidden="true">...</span>`;
                    }
                    paginationHTML += `
                        <button class="pagination-btn" onclick="gameDiscovery.goToPage(${this.totalPages})" aria-label="Page ${this.totalPages}">
                            ${this.totalPages}
                        </button>
                    `;
                }

                // Next button
                paginationHTML += `
                    <button class="pagination-btn ${this.currentPage === this.totalPages ? 'disabled' : ''}"
                            onclick="gameDiscovery.goToPage(${this.currentPage + 1})"
                            ${this.currentPage === this.totalPages ? 'disabled' : ''}
                            aria-label="Next page">
                        ›
                    </button>
                `;

                // Pagination info
                const startItem = (this.currentPage - 1) * this.itemsPerPage + 1;
                const endItem = Math.min(this.currentPage * this.itemsPerPage, this.filteredGames.length);

                paginationHTML += `
                    <div class="pagination-info">
                        ${this.filteredGames.length > 0 ? `${startItem}-${endItem} of` : '0 of'} ${this.filteredGames.length} games
                    </div>
                `;

                pagination.innerHTML = paginationHTML;
            }

            // Enhanced image creation with better error handling and multiple fallback strategies
            createImageElement(game) {
                if (!game.image) {
                    return `
                        <div class="image-fallback">
                            🎮
                            <div class="fallback-text">No Image</div>
                        </div>
                    `;
                }

                // Generate multiple image URL options for better fallback
                const imageOptions = [game.image];
                
                // If it's a Steam header image that fails, try alternative Steam formats
                if (game.image && game.image.includes('steamstatic.com') && game.image.includes('header.jpg')) {
                    const steamId = game.image.match(/\/(\d+)\//)?.[1];
                    if (steamId) {
                        imageOptions.push(
                            `https://cdn.akamai.steamstatic.com/steam/apps/${steamId}/capsule_231x87.jpg`,
                            `https://cdn.akamai.steamstatic.com/steam/apps/${steamId}/capsule_616x353.jpg`,
                            `https://store.steampowered.com/app/${steamId}/header.jpg`
                        );
                    }
                }

                return `
                    <div class="image-container">
                        <div class="image-loading">
                            ⏳
                            <span style="font-size: 12px;">Loading...</span>
                        </div>
                        <img src="${game.image}" 
                             alt="${game.title}" 
                             data-fallbacks='${JSON.stringify(imageOptions.slice(1))}'
                             onload="this.classList.add('loaded'); this.previousElementSibling.classList.add('hidden'); this.nextElementSibling.classList.add('hidden');"
                             onerror="gameDiscovery.handleImageError(this);">
                        <div class="image-fallback">
                            🎮
                            <div class="fallback-text">No Image</div>
                        </div>
                    </div>
                `;
            }

            // Enhanced image error handling with fallback attempts
            handleImageError(imgElement) {
                const fallbacks = JSON.parse(imgElement.getAttribute('data-fallbacks') || '[]');
                const currentSrc = imgElement.src;
                
                // Try next fallback URL
                if (fallbacks.length > 0) {
                    const nextFallback = fallbacks.shift();
                    imgElement.setAttribute('data-fallbacks', JSON.stringify(fallbacks));
                    imgElement.src = nextFallback;
                    return;
                }
                
                // All fallbacks failed, show placeholder
                imgElement.classList.add('error');
                imgElement.previousElementSibling.classList.add('hidden');
                imgElement.nextElementSibling.classList.remove('hidden');
                
                console.warn(`All image fallbacks failed for: ${imgElement.alt}`);
            }

            renderGames(gamesToRender) {
                const grid = document.getElementById('gamesGrid');

                if (gamesToRender.length === 0) {
                    grid.innerHTML = `
                        <div style="grid-column: 1 / -1; text-align: center; color: rgba(255,255,255,0.7); padding: 60px 20px;">
                            <div style="font-size: 4rem; margin-bottom: 20px;">🎮</div>
                            <h3 style="font-size: 1.5rem; margin-bottom: 15px;">No games found</h3>
                            <p style="font-size: 1rem; opacity: 0.8;">Try adjusting your search or filter criteria</p>
                        </div>
                    `;
                    return;
                }

                grid.innerHTML = gamesToRender.map(game => `
                    <div class="game-card" onclick="gameDiscovery.showGameDetails('${game.id}')">
                        <div class="game-id-badge">ID: ${game.id}</div>
                        <div class="game-image">
                            ${this.createImageElement(game)}
                        </div>
                        <div class="game-info">
                            <div class="game-title">${game.title}</div>
                            <div class="game-description">${game.description}</div>
                            <div class="game-meta">
                                <div style="display: flex; flex-direction: column; gap: 8px;">
                                    <div class="game-price">${game.price}</div>
                                    <div class="game-rating">
                                        ⭐ ${game.rating}
                                    </div>
                                </div>
                                ${game.downloadUrl ?
                                    `<button class="download-btn" onclick="gameDiscovery.downloadGame('${game.id}', event)" aria-label="Download ${game.title}">
                                        <span>📥</span>
                                        <span>Download</span>
                                    </button>` :
                                    `<div style="padding: 12px 20px; background: rgba(255,255,255,0.1); border-radius: 25px; color: rgba(255,255,255,0.6); font-size: 0.9rem; text-align: center;">
                                        No Download
                                    </div>`
                                }
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            renderSkeletonCards() {
                const grid = document.getElementById('gamesGrid');
                grid.innerHTML = '';
                for (let i = 0; i < this.itemsPerPage; i++) {
                    grid.innerHTML += `
                        <div class="game-card loading-skeleton">
                            <div class="game-image"></div>
                            <div class="game-info">
                                <div class="game-title">Loading Game Title</div>
                                <div class="game-description">Loading description for the game. Please wait while we fetch the data...</div>
                                <div class="game-meta">
                                    <div style="display: flex; flex-direction: column; gap: 8px;">
                                        <div class="game-price">Free</div>
                                        <div class="game-rating">⭐ 4.5</div>
                                    </div>
                                    <div class="download-btn">Download</div>
                                </div>
                            </div>
                        </div>
                    `;
                }
            }

            clearSkeletonCards() {
                // This is handled by renderGames()
            }

            updateStats() {
                const total = this.games.length;
                const free = this.games.filter(game => game.isFree).length;
                const avgRating = this.games.length > 0 ? 
                    (this.games.reduce((sum, game) => sum + parseFloat(game.rating), 0) / this.games.length).toFixed(1) : 
                    '0.0';

                document.getElementById('totalGames').textContent = total;
                document.getElementById('freeGames').textContent = free;
                document.getElementById('avgRating').textContent = avgRating;
            }

            // Enhanced modal with better image handling and additional metadata
            showGameDetails(gameId) {
                const game = this.games.find(g => g.id === gameId);
                if (!game) return;

                this.currentModalGame = game;

                // Enhanced modal image with fallback handling
                this.modalImage.innerHTML = game.image
                    ? `
                        <div class="image-container">
                            <img src="${game.image}" 
                                 alt="${game.title}" 
                                 data-fallbacks='${JSON.stringify(this.getImageFallbacks(game.image, game.id))}'
                                 onload="this.classList.add('loaded'); this.nextElementSibling.classList.add('hidden');"
                                 onerror="gameDiscovery.handleModalImageError(this);">
                            <div class="image-fallback">🎮</div>
                        </div>
                      `
                    : '<div class="image-fallback">🎮</div>';

                this.modalTitle.textContent = game.title;
                this.modalDescription.textContent = game.description;
                this.modalPrice.textContent = game.price;
                this.modalRating.textContent = `${game.rating}/5.0`;
                this.modalZipFile.textContent = game.zipFile || 'N/A';
                this.modalGameId.textContent = game.gameId || game.id;

                // Add additional metadata if available
                const additionalInfo = [];
                if (game.developer) additionalInfo.push(`Developer: ${game.developer}`);
                if (game.publisher) additionalInfo.push(`Publisher: ${game.publisher}`);
                if (game.releaseDate) additionalInfo.push(`Release: ${game.releaseDate}`);
                if (game.genres && game.genres.length > 0) additionalInfo.push(`Genres: ${game.genres.join(', ')}`);

                // Update description with additional info if available
                if (additionalInfo.length > 0) {
                    this.modalDescription.textContent = game.description + '\n\n' + additionalInfo.join(' • ');
                }

                // Handle download button in modal
                if (game.downloadUrl) {
                    this.modalDownloadBtn.style.display = 'flex';
                    this.modalDownloadBtn.onclick = (e) => this.downloadGame(game.id, e);
                } else {
                    this.modalDownloadBtn.style.display = 'none';
                }

                this.modal.classList.add('open');
                document.body.style.overflow = 'hidden';
                this.closeModalBtn.focus();
            }

            // Get fallback image URLs for a given image
            getImageFallbacks(originalUrl, gameId) {
                const fallbacks = [];
                
                if (originalUrl && originalUrl.includes('steamstatic.com') && originalUrl.includes('header.jpg')) {
                    const steamId = originalUrl.match(/\/(\d+)\//)?.[1];
                    if (steamId) {
                        fallbacks.push(
                            `https://cdn.akamai.steamstatic.com/steam/apps/${steamId}/capsule_231x87.jpg`,
                            `https://cdn.akamai.steamstatic.com/steam/apps/${steamId}/capsule_616x353.jpg`,
                            `https://store.steampowered.com/app/${steamId}/header.jpg`,
                            `https://steamdb.info/app/${steamId}/header.jpg`
                        );
                    }
                } else if (/^\d+$/.test(gameId)) {
                    // If gameId is numeric, try Steam URLs as fallbacks
                    fallbacks.push(
                        `https://cdn.akamai.steamstatic.com/steam/apps/${gameId}/header.jpg`,
                        `https://cdn.akamai.steamstatic.com/steam/apps/${gameId}/capsule_616x353.jpg`,
                        `https://steamdb.info/app/${gameId}/header.jpg`
                    );
                }
                
                return fallbacks;
            }

            // Handle modal image errors with fallbacks
            handleModalImageError(imgElement) {
                const fallbacks = JSON.parse(imgElement.getAttribute('data-fallbacks') || '[]');
                
                if (fallbacks.length > 0) {
                    const nextFallback = fallbacks.shift();
                    imgElement.setAttribute('data-fallbacks', JSON.stringify(fallbacks));
                    imgElement.src = nextFallback;
                    return;
                }
                
                // All fallbacks failed
                imgElement.style.display = 'none';
                imgElement.nextElementSibling.classList.remove('hidden');
            }

            closeModal() {
                this.modal.classList.remove('open');
                document.body.style.overflow = '';
                this.currentModalGame = null;
            }

            // Image zoom functionality
            zoomImage() {
                if (!this.currentModalGame || !this.currentModalGame.image) return;

                this.zoomedImage.src = this.currentModalGame.image;
                this.zoomedImage.alt = this.currentModalGame.title;
                this.imageZoomOverlay.classList.add('open');
            }

            closeImageZoom() {
                this.imageZoomOverlay.classList.remove('open');
                setTimeout(() => {
                    this.zoomedImage.src = '';
                }, 300);
            }

            downloadGame(gameId, event) {
                event.stopPropagation();
                const game = this.games.find(g => g.id === gameId);

                if (game && game.downloadUrl) {
                    const link = document.createElement('a');
                    link.href = game.downloadUrl;
                    link.download = game.zipFile || `${game.title.replace(/[^a-z0-9]/gi, '_').toLowerCase()}.zip`;
                    link.target = '_blank';
                    link.rel = 'noopener noreferrer';

                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);

                    this.showDownloadNotification(game.title);
                    if (this.modal.classList.contains('open')) {
                        this.closeModal();
                    }
                } else {
                    this.showError('Download not available for this game');
                }
            }

            showDownloadNotification(gameTitle) {
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: linear-gradient(135deg, rgba(76, 175, 80, 0.95), rgba(56, 142, 60, 0.95));
                    color: white;
                    padding: 18px 25px;
                    border-radius: 15px;
                    backdrop-filter: blur(15px);
                    box-shadow: 0 8px 30px rgba(0,0,0,0.4), 0 0 0 1px rgba(255,255,255,0.1);
                    z-index: 2500;
                    font-weight: 600;
                    font-size: 14px;
                    transform: translateX(120%);
                    transition: transform 0.4s cubic-bezier(0.23, 1, 0.320, 1);
                    max-width: 300px;
                    word-wrap: break-word;
                `;
                notification.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <span style="font-size: 18px;">📥</span>
                        <div>
                            <div style="font-weight: 700; margin-bottom: 2px;">Download Started</div>
                            <div style="opacity: 0.9; font-size: 12px;">${gameTitle}</div>
                        </div>
                    </div>
                `;

                document.body.appendChild(notification);

                setTimeout(() => {
                    notification.style.transform = 'translateX(0)';
                }, this.NOTIFICATION_SHOW_DELAY);

                setTimeout(() => {
                    notification.style.transform = 'translateX(120%)';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            document.body.removeChild(notification);
                        }
                    }, this.NOTIFICATION_HIDE_DURATION);
                }, this.NOTIFICATION_DURATION);
            }

            showLoading(show) {
                document.getElementById('loading').style.display = show ? 'block' : 'none';
            }

            showError(message) {
                const errorDiv = document.getElementById('error');
                errorDiv.textContent = message;
                errorDiv.style.display = 'block';
                
                // Auto-hide error after 5 seconds
                setTimeout(() => {
                    this.hideError();
                }, 5000);
            }

            hideError() {
                document.getElementById('error').style.display = 'none';
            }
        }

        // Initialize the app
        const gameDiscovery = new GameDiscovery();

        // Make handleImageError available globally for onclick handlers
        window.gameDiscovery = gameDiscovery;

        // Add some global error handling
        window.addEventListener('error', (e) => {
            console.error('Global error:', e.error);
        });

        window.addEventListener('unhandledrejection', (e) => {
            console.error('Unhandled promise rejection:', e.reason);
        });

        // Add image optimization and caching
        const imageCache = new Map();
        const originalCreateElement = document.createElement;
        
        // Enhanced image loading with caching and optimization
        function optimizeImageLoading() {
            const images = document.querySelectorAll('img[data-fallbacks]');
            images.forEach(img => {
                if (!img.complete && !img.classList.contains('loading-optimized')) {
                    img.classList.add('loading-optimized');
                    
                    // Add intersection observer for lazy loading
                    if ('IntersectionObserver' in window) {
                        const imageObserver = new IntersectionObserver((entries) => {
                            entries.forEach(entry => {
                                if (entry.isIntersecting) {
                                    const img = entry.target;
                                    if (!img.src || img.src.includes('data:')) {
                                        const originalSrc = img.getAttribute('data-original-src');
                                        if (originalSrc) {
                                            img.src = originalSrc;
                                        }
                                    }
                                    imageObserver.unobserve(img);
                                }
                            });
                        });
                        imageObserver.observe(img);
                    }
                }
            });
        }

        // Run image optimization periodically
        setInterval(optimizeImageLoading, 2000);

        // Preload critical images when app loads
        document.addEventListener('DOMContentLoaded', () => {
            // Preload some common Steam image patterns
            const commonSteamIds = ['10', '240', '500', '730']; // Counter-Strike, Counter-Strike: Source, Left 4 Dead 2, Counter-Strike: Global Offensive
            commonSteamIds.forEach(id => {
                const link = document.createElement('link');
                link.rel = 'preload';
                link.as = 'image';
                link.href = `https://cdn.akamai.steamstatic.com/steam/apps/${id}/header.jpg`;
                document.head.appendChild(link);
            });
        });
    </script>
</body>
</html>
